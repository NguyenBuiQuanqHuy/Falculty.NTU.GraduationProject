<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Chỉnh sửa hồ sơ</title>
  <link rel="stylesheet" th:href="@{/css/updateProfile.css}" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
  <script src="https://cdn.tiny.cloud/1/2dywnvukp3hvbouvd54bf9lxkgr40hwpk46kpiy6ugiqsxcl/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
  <style>
    a { text-decoration: none; }
  </style>
</head>
<body>
<div th:replace="~{layout/header :: header}"></div>
<div th:fragment="content">
  <div class="form-container">
    <form th:action="@{/updateProfile}" method="post" class="profile-form">
      <div class="form-right">
        <label>Hồ sơ năng lực</label>
        <textarea id="cv" name="cv" class="cv" th:text="${giangVien.cv}"></textarea>
        <div class="button-group">
          <button type="submit" class="btn save">Lưu</button>
          <a th:href="@{/profile}" class="btn cancel">Hủy</a>
        </div>
      </div>
    </form>
  </div>
</div>

<div th:replace="~{layout/footer :: footer}"></div>
</body>
</html>
<script>
  tinymce.init({
    selector: 'textarea.cv',
    language: 'vi',
    height: 350,
    plugins: 'advlist autolink lists link image charmap preview anchor pagebreak code fullscreen table emoticons autosave',
    toolbar: 'undo redo | styles | bold italic underline strikethrough | forecolor backcolor | fontselect fontsizeselect | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image table | emoticons | fullscreen preview code',
    menubar: 'file edit view insert format tools table',
    image_title: true,
    automatic_uploads: true,
    file_picker_types: 'image',
    file_picker_callback: function (cb, value, meta) {
      const input = document.createElement('input');
      input.setAttribute('type', 'file');
      input.setAttribute('accept', 'image/*');
      input.onchange = function () {
        const file = this.files[0];
        const reader = new FileReader();
        reader.onload = function () {
          const id = 'blobid' + (new Date()).getTime();
          const blobCache = tinymce.activeEditor.editorUpload.blobCache;
          const base64 = reader.result.split(',')[1];
          const blobInfo = blobCache.create(id, file, base64);
          blobCache.add(blobInfo);
          cb(blobInfo.blobUri(), { title: file.name });
        };
        reader.readAsDataURL(file);
      };
      input.click();
    },
    autosave_interval: '30s',
    autosave_retention: '5m',
    content_style: "body { font-family:Arial,sans-serif; font-size:14px }"
  });
</script>

